<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pitching Stats - Parkrose MS Baseball</title>
    <link rel="stylesheet" href="styles.css"> </head>
<body>

    <h1>Pitching Statistics</h1>

    <table>
        <thead>
            <tr>
                <th>Player Name</th>
                <th>W</th><th>L</th><th>ERA</th><th>G</th><th>IP</th>
                <th>H</th><th>R</th><th>ER</th><th>BB</th><th>SO</th>
                <th>WHIP</th>
            </tr>
        </thead>
        <tbody id="pitching-tbody">
            <tr><td colspan="12">Loading stats...</td></tr> </tbody>
    </table>
     <div id="error-container"></div> <a href="index.html" class="nav-link">&laquo; Back to Home</a>

    <script>
        // --- Copy the SAME loadCsvData function from batting.html here ---
async function loadCsvData(csvFilename, tbodyId, errorContainerId, expectedColumns) {
    const tbody = document.getElementById(tbodyId);
    const errorContainer = document.getElementById(errorContainerId);
    tbody.innerHTML = `<tr><td colspan="${expectedColumns}">Loading stats...</td></tr>`;
    errorContainer.innerHTML = '';

    try {
        console.log(`Workspaceing: ${csvFilename}`); // Debug: Log filename
        const response = await fetch(csvFilename);
        console.log(`Workspace response status for ${csvFilename}: ${response.status}`); // Debug: Log status

        if (!response.ok) {
            throw new Error(`Network response was not ok: ${response.statusText} (Status: ${response.status}). Check file path and permissions on the server.`);
        }

        const csvData = await response.text();
        // --- Debug: Log the raw data received ---
        console.log(`--- Raw CSV Data for ${csvFilename} ---`);
        console.log(csvData);
        console.log(`--- End Raw CSV Data ---`);

        // --- Use more robust line splitting ---
        const lines = csvData.trim().split(/\r?\n/);

        // --- Debug: Log the number of lines found ---
        console.log(`Number of lines found after split for ${csvFilename}: ${lines.length}`);
        // console.log('Lines array:', lines); // Optional: Uncomment to see the lines array itself

        if (lines.length <= 1 || (lines.length === 1 && lines[0] === '')) { // Also check if trimming resulted in just an empty string
            tbody.innerHTML = `<tr><td colspan="${expectedColumns}">No data rows found in CSV file (lines found: ${lines.length}). Check CSV content and structure.</td></tr>`;
            console.warn(`CSV file '${csvFilename}' appears to have no data rows after splitting.`);
            return; // No data rows
        }

        tbody.innerHTML = ''; // Clear "Loading..." message

        // Start from 1 to skip header row
        for (let i = 1; i < lines.length; i++) {
             // Ignore potential empty lines at the end of the file
            if (lines[i].trim() === '') {
                continue;
            }
            const values = lines[i].split(','); // Split row into columns/values
            if (values.length < expectedColumns) {
                console.warn(`Row ${i + 1} in ${csvFilename} has fewer columns (${values.length}) than expected (${expectedColumns}). Skipping row. Content: "${lines[i]}"`);
                continue; // Skip rows that don't have enough columns
            }

            const row = document.createElement('tr');
            for (let j = 0; j < expectedColumns; j++) {
                const cell = document.createElement('td');
                // Use value or empty string if undefined/null after split
                cell.textContent = values[j] ? values[j].trim() : '';
                row.appendChild(cell);
            }
            tbody.appendChild(row);
        }
        console.log(`Successfully processed ${lines.length -1} potential data lines from ${csvFilename}`);

    } catch (error) {
        console.error(`Error loading or parsing CSV (${csvFilename}):`, error);
        tbody.innerHTML = ''; // Clear table body on error
        errorContainer.innerHTML = `<p class="error-message">Error loading stats (${csvFilename}): ${error.message}</p>`;
    }
}

        // Run the function for this page
        document.addEventListener('DOMContentLoaded', () => {
            loadCsvData('pitching stats.csv', 'pitching-tbody', 'error-container', 12); // 12 = number of columns in pitching table
        });
    </script>

</body>
</html>