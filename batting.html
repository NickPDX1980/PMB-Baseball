<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Batting Stats - Parkrose MS Baseball</title>
    <link rel="stylesheet" href="styles.css"> </head>
<body>

    <h1>Batting Statistics</h1>

    <table>
        <thead>
            <tr>
                <th>Player Name</th>
                <th>G</th><th>PA</th><th>AB</th><th>R</th><th>H</th>
                <th>2B</th><th>3B</th><th>HR</th><th>RBI</th><th>BB</th>
                <th>SO</th><th>AVG</th><th>OBP</th><th>SLG</th>
            </tr>
        </thead>
        <tbody id="batting-tbody">
            <tr><td colspan="15">Loading stats...</td></tr> </tbody>
    </table>
    <div id="error-container"></div> <a href="index.html" class="nav-link">&laquo; Back to Home</a>

    <script>
        async function loadCsvData(csvFilename, tbodyId, errorContainerId, expectedColumns) {
            const tbody = document.getElementById(tbodyId);
            const errorContainer = document.getElementById(errorContainerId);
            tbody.innerHTML = `<tr><td colspan="${expectedColumns}">Loading stats...</td></tr>`; // Clear previous content/show loading
            errorContainer.innerHTML = ''; // Clear previous errors

            try {
                const response = await fetch(csvFilename);
                if (!response.ok) {
                    throw new Error(`Network response was not ok: ${response.statusText} (Status: ${response.status}). Check if the file '${csvFilename}' exists in the same folder as the HTML file.`);
                }
                const csvData = await response.text();
                const lines = csvData.trim().split('\\n'); // Split into rows

                if (lines.length <= 1) {
                    tbody.innerHTML = `<tr><td colspan="${expectedColumns}">No data found in CSV file.</td></tr>`;
                    return; // No data rows
                }

                tbody.innerHTML = ''; // Clear "Loading..." message

                // Start from 1 to skip header row
                for (let i = 1; i < lines.length; i++) {
                    const values = lines[i].split(','); // Split row into columns/values
                    if (values.length < expectedColumns) {
                        console.warn(`Row ${i+1} has fewer columns (${values.length}) than expected (${expectedColumns}). Skipping row.`);
                        continue; // Skip rows that don't have enough columns
                    }

                    const row = document.createElement('tr');
                    for (let j = 0; j < expectedColumns; j++) {
                        const cell = document.createElement('td');
                        cell.textContent = values[j] ? values[j].trim() : ''; // Trim whitespace, handle potentially empty cells
                        row.appendChild(cell);
                    }
                    tbody.appendChild(row);
                }

            } catch (error) {
                console.error('Error loading or parsing CSV:', error);
                tbody.innerHTML = ''; // Clear table body on error
                errorContainer.innerHTML = `<p class="error-message">Error loading stats: ${error.message}</p>`;
            }
        }

        // Run the function when the page content is loaded
        document.addEventListener('DOMContentLoaded', () => {
            loadCsvData('batting stats.csv', 'batting-tbody', 'error-container', 15); // 15 = number of columns in batting table
        });
    </script>

</body>
</html>